<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ULTIMATE TRENING IPSec - 80 Pyta</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f0f2f5; color: #333; line-height: 1.6; margin: 0; padding: 20px; }
        .container { max-width: 950px; margin: 0 auto; background: #fff; padding: 30px; border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        h1 { color: #2c3e50; text-align: center; border-bottom: 2px solid #eee; padding-bottom: 20px; }
        
        /* Sekcja notatki */
        .note-section { background-color: #e3f2fd; border-left: 6px solid #2196f3; padding: 20px; margin-bottom: 40px; border-radius: 5px; }
        .note-section h2 { margin-top: 0; color: #1565c0; }
        .note-section ul { margin-bottom: 15px; }
        .highlight { font-weight: bold; color: #d32f2f; }

        /* Style pyta */
        .question-block { margin-bottom: 30px; padding: 20px; border: 1px solid #e0e0e0; border-radius: 8px; background: #fafafa; transition: transform 0.2s; }
        .question-block:hover { box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
        
        .question-text { font-size: 1.1em; margin-bottom: 15px; font-weight: 600; }
        
        /* SPECJALNY STYL DLA PYTA ZE ZDJ */
        .source-question { 
            font-size: 1.25em; 
            font-weight: 800; 
            color: #c0392b; 
            border-left: 5px solid #c0392b; 
            padding-left: 10px;
            background-color: #fff5f5;
        }

        .type-badge { font-size: 0.85em; color: #7f8c8d; font-style: italic; display: block; margin-bottom: 10px; }

        /* Odpowiedzi */
        .options { list-style-type: none; padding: 0; }
        .option { margin: 8px 0; padding: 12px 15px; border: 2px solid #e0e0e0; border-radius: 6px; cursor: pointer; transition: all 0.2s; background: white; display: flex; align-items: center; }
        .option:hover { border-color: #bdc3c7; background-color: #f9f9f9; }
        
        /* Inputy */
        input[type="radio"], input[type="checkbox"] { margin-right: 15px; transform: scale(1.2); cursor: pointer; }

        /* Kolory weryfikacji */
        .correct-clicked { background-color: #d4edda !important; border-color: #28a745 !important; color: #155724; }
        .wrong-clicked { background-color: #f8d7da !important; border-color: #dc3545 !important; color: #721c24; }

        /* Wynik */
        #result-box { margin-top: 30px; padding: 25px; background: #34495e; color: #fff; font-size: 1.3em; text-align: center; border-radius: 8px; display: none; }
        button.check-btn { display: block; width: 100%; padding: 18px; background-color: #27ae60; color: white; border: none; border-radius: 8px; font-size: 1.3em; font-weight: bold; cursor: pointer; margin-top: 30px; transition: background 0.3s; }
        button.check-btn:hover { background-color: #219150; }

        .legend { font-size: 0.9em; margin-bottom: 20px; text-align: center; color: #555; }
        .source-tag { display: inline-block; background: #c0392b; color: white; padding: 2px 6px; border-radius: 4px; font-size: 0.7em; margin-left: 10px; vertical-align: middle; }
    </style>
</head>
<body>

<div class="container">
    <h1>Kompleksowy Trening IPSec & VPN (80 Pyta)</h1>
    
    <div class="legend">
        <span style="color: #c0392b; font-weight: 800;">Czerwony i pogrubiony tekst</span> = Pytania ze zdj (PEWNIAKI)
    </div>

    <div class="note-section">
        <h2> ciga Przed Egzaminem (Przeczytaj!)</h2>
        
        <h3>1. Protokoy (Nag贸wki)</h3>
        <ul>
            <li><strong>AH (Authentication Header):</strong> Zapewnia integralno i uwierzytelnianie 藕r贸da. <span class="highlight">NIE SZYFRUJE (brak poufnoci)</span>.</li>
            <li><strong>ESP (Encapsulating Security Payload):</strong> Zapewnia <span class="highlight">POUFNO (szyfrowanie)</span> + integralno + uwierzytelnianie.</li>
        </ul>

        <h3>2. Tryby Pracy</h3>
        <ul>
            <li><strong>Transportowy:</strong> Host-to-Host. Oryginalny nag贸wek IP jest zachowany. Szyfruje tylko dane.</li>
            <li><strong>Tunelowy:</strong> Site-to-Site (Brama-Brama). <span class="highlight">Cay pakiet wchodzi w NOWY nag贸wek IP</span>.</li>
        </ul>

        <h3>3. Fazy Konfiguracji (Klucz do pyta!)</h3>
        <ul>
            <li><strong>FAZA I (ISAKMP/IKE):</strong> Negocjacja "jak bdziemy gada".
                <br>Polecenie: <code>crypto isakmp policy</code>
                <br>Parametry: Encryption (DES/AES), Hash (MD5/SHA), Auth (pre-share), Group (Diffie-Hellman), Lifetime.
            </li>
            <li><strong>FAZA II (IPSec):</strong> Negocjacja "jak szyfrujemy dane".
                <br>Polecenie: <code>crypto ipsec transform-set</code>
                <br>Parametry: Algorytmy danych (esp-aes), <span class="highlight">Tryb tunelu (mode tunnel)</span>.
            </li>
        </ul>

        <h3>4. Konfiguracja Crypto Map (Sklejanie caoci)</h3>
        <ul>
            <li>Polecenie: <code>crypto map NAZWA</code>.</li>
            <li>czy: <code>match address</code> (ACL - jaki ruch?), <code>set peer</code> (do kogo?), <code>set transform-set</code> (jak szyfrowa?).</li>
        </ul>
    </div>

    <form id="quiz-form">
        <div id="questions-container"></div>
    </form>

    <button class="check-btn" onclick="checkScore()">Zakocz i Sprawd藕 Wynik</button>
    <div id="result-box"></div>
</div>

<script>
    /* BAZA PYTA
       isSource: true -> pytania ze zdj (pogrubione)
       type: 'multi' (wielokrotny) lub 'single' (jednokrotny)
    */
    const questionsDB = [
        // ==========================================
        // PYTANIA ZE ZDJ (8 sztuk) - PRIORYTETOWE
        // ==========================================
        {
            question: "Jakie elementy pakietu s zabezpieczane w protokole IPSec AH w trybie tunelowym? (Zaznacz poprawne)",
            type: "multi",
            isSource: true,
            answers: [
                { text: "poufno pola danych", correct: false },
                { text: "uwierzytelnianie 藕r贸da transmisji", correct: true },
                { text: "czas dostarczenia", correct: false },
                { text: "trasa pakietu", correct: false },
                { text: "integralno pola danych", correct: true }
            ]
        },
        {
            question: "Rodzaj algorytmu szyfrowania tunelu IPsec definiowany jest:",
            type: "single",
            isSource: true,
            answers: [
                { text: "w fazie II konfiguracji tunelu", correct: true },
                { text: "ustawiany jest automatycznie w trakcie zestawiania tunelu", correct: false },
                { text: "w fazie I konfiguracji tunelu", correct: false },
                { text: "w trakcie definiowania crypto-map'y", correct: false }
            ]
        },
        {
            question: "IKE to:",
            type: "single",
            isSource: true,
            answers: [
                { text: "faza I IPsec", correct: false },
                { text: "protok贸 wymiany kluczy w fazie II", correct: false },
                { text: "protok贸 wymiany kluczy w fazie I", correct: true },
                { text: "faza II IPsec", correct: false }
            ]
        },
        {
            question: "Polecenie 'crypto isakmp policy nr' su偶y do:",
            type: "single",
            isSource: true,
            answers: [
                { text: "powizania listy ACL z tunelem", correct: false },
                { text: "wskazania polityki, kt贸rej akcj bdzie zestawienie tunelu", correct: false },
                { text: "rozpoczcia konfiguracji parametr贸w fazy I", correct: true },
                { text: "powizania tunelu z list ACL wskazujc ruch do szyfrowania", correct: false }
            ]
        },
        {
            question: "Mianem ISAKMP przyjo si okrela:",
            type: "single",
            isSource: true,
            answers: [
                { text: "klucze asymetryczne", correct: false },
                { text: "drug faz IPsec", correct: false },
                { text: "klucze symetryczne", correct: false },
                { text: "pierwsz faz IPsec", correct: true }
            ]
        },
        {
            question: "Jakie elementy pakietu s zabezpieczane w protokole IPSec AH w trybie transportowym? (Zaznacz poprawne)",
            type: "multi",
            isSource: true,
            answers: [
                { text: "uwierzytelnianie 藕r贸da transmisji", correct: true },
                { text: "trasa pakietu", correct: false },
                { text: "poufno pola danych", correct: false },
                { text: "integralno pola danych", correct: true },
                { text: "czas dostarczenia", correct: false }
            ]
        },
        {
            question: "Typ tunelu (transportowy lub tunelowy) definiuje si:",
            type: "single",
            isSource: true,
            answers: [
                { text: "w fazie II konfiguracji tunelu", correct: true },
                { text: "ustawiany jest automatycznie", correct: false },
                { text: "w fazie I konfiguracji tunelu", correct: false },
                { text: "w trakcie definiowania crypto-map'y", correct: false }
            ]
        },
        {
            question: "Jakie elementy pakietu s zabezpieczane w protokole IPSec ESP w trybie transportowym? (Zaznacz poprawne)",
            type: "multi",
            isSource: true,
            answers: [
                { text: "tras pakietu", correct: false },
                { text: "uwierzytelnianie 藕r贸da transmisji", correct: true },
                { text: "poufno pola danych", correct: true },
                { text: "integralno pola danych", correct: true },
                { text: "czas wysania", correct: false }
            ]
        },

        // ==========================================
        // PYTANIA Z POPRZEDNIEJ BAZY (TEORIA I PODSTAWY)
        // ==========================================
        {
            question: "Kt贸ry protok贸 zapewnia POUFNO (szyfrowanie) przesyanych danych?",
            type: "single",
            answers: [
                { text: "AH (Authentication Header)", correct: false },
                { text: "ESP (Encapsulating Security Payload)", correct: true },
                { text: "IKE", correct: false },
                { text: "ISAKMP", correct: false }
            ]
        },
        {
            question: "W kt贸rym trybie pracy IPSec oryginalny nag贸wek IP jest zachowany (niezmieniony)?",
            type: "single",
            answers: [
                { text: "Tryb tunelowy", correct: false },
                { text: "Tryb transportowy", correct: true },
                { text: "W obu trybach", correct: false },
                { text: "W 偶adnym z tryb贸w", correct: false }
            ]
        },
        {
            question: "Kt贸re polecenie su偶y do sprawdzenia aktywnych tuneli IPSec (SA) i licznik贸w pakiet贸w?",
            type: "single",
            answers: [
                { text: "show crypto isakmp policy", correct: false },
                { text: "show crypto map", correct: false },
                { text: "show crypto ipsec sa", correct: true },
                { text: "debug crypto ipsec", correct: false }
            ]
        },
        {
            question: "W kt贸rej fazie konfiguracji definiuje si grup Diffie-Hellmana (komenda 'group')?",
            type: "single",
            answers: [
                { text: "Faza I (ISAKMP)", correct: true },
                { text: "Faza II (IPSec)", correct: false },
                { text: "Podczas tworzenia Crypto ACL", correct: false },
                { text: "Podczas przypisywania mapy do interfejsu", correct: false }
            ]
        },
        {
            question: "Jaki jest g贸wny cel stosowania listy kontroli dostpu (ACL) w konfiguracji VPN IPSec?",
            type: "single",
            answers: [
                { text: "Blokowanie wirus贸w", correct: false },
                { text: "Definiowanie ruchu, kt贸ry ma zosta zaszyfrowany (interesujcy ruch)", correct: true },
                { text: "Uwierzytelnianie u偶ytkownik贸w", correct: false },
                { text: "Konfiguracja routingu dynamicznego", correct: false }
            ]
        },
        {
            question: "Gdzie konfiguruje si polecenie 'mode tunnel'?",
            type: "single",
            answers: [
                { text: "W konfiguracji ISAKMP Policy (Faza I)", correct: false },
                { text: "W konfiguracji Transform-Set (Faza II)", correct: true },
                { text: "W konfiguracji interfejsu", correct: false },
                { text: "Globalnie w trybie konfiguracji", correct: false }
            ]
        },
        {
            question: "Czym jest 'Transform-Set' w IPSec?",
            type: "single",
            answers: [
                { text: "Zbiorem parametr贸w Fazy I (wymiany kluczy)", correct: false },
                { text: "List dozwolonych adres贸w IP", correct: false },
                { text: "Zbiorem algorytm贸w szyfrowania i haszowania dla danych (Faza II)", correct: true },
                { text: "Kluczem wsp贸dzielonym (Pre-shared key)", correct: false }
            ]
        },
        {
            question: "Kt贸ry algorytm su偶y do weryfikacji integralnoci (jest funkcj skr贸tu)?",
            type: "single",
            answers: [
                { text: "AES", correct: false },
                { text: "3DES", correct: false },
                { text: "SHA-1", correct: true },
                { text: "Diffie-Hellman", correct: false }
            ]
        },
        {
            question: "Kt贸ry algorytm jest przykadem algorytmu asymetrycznego u偶ywanego przy wymianie kluczy?",
            type: "single",
            answers: [
                { text: "AES", correct: false },
                { text: "Diffie-Hellman", correct: true },
                { text: "MD5", correct: false },
                { text: "DES", correct: false }
            ]
        },
        {
            question: "Co robi nag贸wek AH (Authentication Header) z poufnoci danych?",
            type: "single",
            answers: [
                { text: "Szyfruje dane u偶ywajc AES", correct: false },
                { text: "Szyfruje dane u偶ywajc DES", correct: false },
                { text: "Nie zapewnia poufnoci (nie szyfruje danych)", correct: true },
                { text: "Szyfruje tylko nag贸wek IP", correct: false }
            ]
        },
        {
            question: "W trybie tunelowym, co dzieje si z oryginalnym pakietem IP?",
            type: "single",
            answers: [
                { text: "Jest usuwany i zastpowany nowym", correct: false },
                { text: "Jest modyfikowany (zmieniany jest TTL)", correct: false },
                { text: "Jest kapsukowany (pakowany) w caoci w nowy pakiet IP", correct: true },
                { text: "Jest wysyany bez zmian obok pakietu szyfrowanego", correct: false }
            ]
        },
        {
            question: "Jakie polecenie czy ACL, Peer IP i Transform-set w jedn cao?",
            type: "single",
            answers: [
                { text: "crypto isakmp policy", correct: false },
                { text: "crypto map", correct: true },
                { text: "ip route", correct: false },
                { text: "access-group", correct: false }
            ]
        },
        {
            question: "Co oznacza skr贸t SA?",
            type: "single",
            answers: [
                { text: "System Administrator", correct: false },
                { text: "Security Association (Relacja zabezpiecze)", correct: true },
                { text: "Secure Algorithm", correct: false },
                { text: "Socket Address", correct: false }
            ]
        },
        {
            question: "Relacja zabezpiecze (SA) jest z natury:",
            type: "single",
            answers: [
                { text: "Dwukierunkowa", correct: false },
                { text: "Jednokierunkowa", correct: true },
                { text: "Bezkierunkowa", correct: false },
                { text: "Zale偶na od protokou routingu", correct: false }
            ]
        },
        {
            question: "Kt贸ry z poni偶szych algorytm贸w szyfrowania symetrycznego jest najbezpieczniejszy (standardowy)?",
            type: "single",
            answers: [
                { text: "DES", correct: false },
                { text: "AES", correct: true },
                { text: "MD5", correct: false },
                { text: "RC4", correct: false }
            ]
        },
        {
            question: "Usuga 'anti-replay' (zapobieganie powt贸rzeniom) jest dostpna w:",
            type: "single",
            answers: [
                { text: "Tylko w AH", correct: false },
                { text: "Tylko w ESP", correct: false },
                { text: "Zar贸wno w AH jak i ESP", correct: true },
                { text: "W 偶adnym z nich", correct: false }
            ]
        },
        {
            question: "Konfiguracja 'crypto isakmp key cisco address 10.0.0.1' ustawia:",
            type: "single",
            answers: [
                { text: "Klucz publiczny RSA", correct: false },
                { text: "Haso (klucz pre-shared) dla peera 10.0.0.1", correct: true },
                { text: "Adres IP wasnego interfejsu", correct: false },
                { text: "Polityk routingu", correct: false }
            ]
        },
        {
            question: "W topologii Hub & Spoke:",
            type: "single",
            answers: [
                { text: "Ka偶dy czy si z ka偶dym (Full Mesh)", correct: false },
                { text: "Istnieje centralne urzdzenie poredniczce w tunelach", correct: true },
                { text: "Nie u偶ywa si tuneli IPSec", correct: false },
                { text: "Tunele s zestawiane losowo", correct: false }
            ]
        },
        {
            question: "Co konfigurujemy poleceniem 'lifetime' w polityce ISAKMP?",
            type: "single",
            answers: [
                { text: "Czas 偶ycia pakietu (TTL)", correct: false },
                { text: "Czas wa偶noci relacji zabezpiecze (kluczy) w fazie I", correct: true },
                { text: "Op贸藕nienie transmisji", correct: false },
                { text: "Liczb dozwolonych u偶ytkownik贸w", correct: false }
            ]
        },
        {
            question: "Tryb transportowy jest najczciej stosowany w poczeniach typu:",
            type: "single",
            answers: [
                { text: "Site-to-Site (Router-Router)", correct: false },
                { text: "Host-to-Host (End-to-End)", correct: true },
                { text: "Tylko w IPv6", correct: false },
                { text: "Tylko w sieciach publicznych", correct: false }
            ]
        },
        {
            question: "Kt贸ry tryb jest typowy dla VPN Site-to-Site (Brama-Brama)?",
            type: "single",
            answers: [
                { text: "Tryb transportowy", correct: false },
                { text: "Tryb tunelowy", correct: true },
                { text: "Tryb hybrydowy", correct: false },
                { text: "Tryb AH", correct: false }
            ]
        },
        {
            question: "Algorytm MD5 su偶y do:",
            type: "single",
            answers: [
                { text: "Szyfrowania danych", correct: false },
                { text: "Wymiany kluczy", correct: false },
                { text: "Weryfikacji integralnoci (Hash)", correct: true },
                { text: "Kompresji danych", correct: false }
            ]
        },
        {
            question: "Aby zastosowa VPN na interfejsie routera, u偶ywamy polecenia:",
            type: "single",
            answers: [
                { text: "ip address ...", correct: false },
                { text: "encapsulation dot1q ...", correct: false },
                { text: "crypto map <nazwa_mapy>", correct: true },
                { text: "crypto enable", correct: false }
            ]
        },
        {
            question: "Element 'set peer 10.0.0.1' w crypto-mapie definiuje:",
            type: "single",
            answers: [
                { text: "Adres IP hosta lokalnego", correct: false },
                { text: "Adres IP bramy zdalnej (koca tunelu)", correct: true },
                { text: "Adres serwera DNS", correct: false },
                { text: "Adres sieci chronionej", correct: false }
            ]
        },
        {
            question: "Co oznacza skr贸t VPN?",
            type: "single",
            answers: [
                { text: "Very Private Network", correct: false },
                { text: "Virtual Private Network", correct: true },
                { text: "Virtual Public Network", correct: false },
                { text: "Verified Packet Network", correct: false }
            ]
        },
        {
            question: "Kt贸ry protok贸 funkcjonuje w warstwie sieciowej modelu ISO/OSI?",
            type: "single",
            answers: [
                { text: "SSL", correct: false },
                { text: "IPSec", correct: true },
                { text: "SSH", correct: false },
                { text: "L2TP", correct: false }
            ]
        },
        {
            question: "Co zapewnia algorytm Diffiego-Hellmana?",
            type: "single",
            answers: [
                { text: "Szyfrowanie caej transmisji", correct: false },
                { text: "Bezpieczne uzgodnienie wsp贸lnego klucza sekretnego w niezabezpieczonym kanale", correct: true },
                { text: "Kompresj nag贸wk贸w", correct: false },
                { text: "Routing pakiet贸w", correct: false }
            ]
        },
        {
            question: "Parametr 'authentication pre-share' w polityce ISAKMP oznacza:",
            type: "single",
            answers: [
                { text: "Uwierzytelnianie certyfikatami cyfrowymi", correct: false },
                { text: "Uwierzytelnianie wsp贸dzielonym hasem", correct: true },
                { text: "Brak uwierzytelniania", correct: false },
                { text: "Uwierzytelnianie biometryczne", correct: false }
            ]
        },
        {
            question: "W kt贸rym miejscu pakietu znajduje si nag贸wek ESP w trybie transportowym?",
            type: "single",
            answers: [
                { text: "Na samym pocztku (przed IP)", correct: false },
                { text: "Pomidzy oryginalnym nag贸wkiem IP a danymi (np. TCP)", correct: true },
                { text: "Na samym kocu pakietu", correct: false },
                { text: "Zastpuje nag贸wek IP", correct: false }
            ]
        },
        {
            question: "Do czego su偶y polecenie 'match address' w crypto-mapie?",
            type: "single",
            answers: [
                { text: "Do sprawdzenia adresu MAC", correct: false },
                { text: "Do powizania listy ACL definiujcej ruch do szyfrowania", correct: true },
                { text: "Do ustawienia adresu IP routera", correct: false },
                { text: "Do dopasowania klucza", correct: false }
            ]
        },
        {
            question: "Weryfikacja 藕r贸da pochodzenia pakietu w IPSec ma na celu:",
            type: "single",
            answers: [
                { text: "Zwikszenie prdkoci transmisji", correct: false },
                { text: "Eliminacj mo偶liwoci podszywania si pod inny adres (IP Spoofing)", correct: true },
                { text: "Kompresj danych", correct: false },
                { text: "Zmian trasy routingu", correct: false }
            ]
        },
        {
            question: "Czy protok贸 IPSec mo偶e by wykorzystywany przez IPv6?",
            type: "single",
            answers: [
                { text: "Tak", correct: true },
                { text: "Nie, tylko IPv4", correct: false },
                { text: "Tylko w trybie transportowym", correct: false }
            ]
        },
        {
            question: "Co oznacza skr贸t SPI w nag贸wku IPSec?",
            type: "single",
            answers: [
                { text: "Secure Private Interface", correct: false },
                { text: "Security Parameters Index", correct: true },
                { text: "Serial Port Interface", correct: false },
                { text: "Standard Protocol ID", correct: false }
            ]
        },
        {
            question: "Kt贸re stwierdzenie o relacji zabezpiecze (SA) jest prawdziwe?",
            type: "single",
            answers: [
                { text: "Jest zawsze dwukierunkowa", correct: false },
                { text: "Jest jednoznacznie definiowana m.in. przez SPI i adres docelowy", correct: true },
                { text: "Nie wymaga negocjacji", correct: false },
                { text: "Dziaa tylko w warstwie aplikacji", correct: false }
            ]
        },
        {
            question: "Co konfiguruje polecenie 'encr 3des' w polityce ISAKMP?",
            type: "single",
            answers: [
                { text: "Algorytm haszowania", correct: false },
                { text: "Algorytm szyfrowania kanau wymiany kluczy (Faza I)", correct: true },
                { text: "Czas 偶ycia tunelu", correct: false },
                { text: "Metod uwierzytelniania", correct: false }
            ]
        },
        {
            question: "Czy protok贸 AH szyfruje dane u偶ytkownika?",
            type: "single",
            answers: [
                { text: "Tak, zawsze", correct: false },
                { text: "Tak, ale sabo", correct: false },
                { text: "Nie, zapewnia tylko integralno i autentyczno", correct: true },
                { text: "Zale偶y od konfiguracji", correct: false }
            ]
        },
        {
            question: "Jaki jest cel stosowania certyfikat贸w cyfrowych (X.509) w VPN?",
            type: "single",
            answers: [
                { text: "Szyfrowanie danych w Fazie II", correct: false },
                { text: "Uwierzytelnianie stron (alternatywa dla pre-shared keys)", correct: true },
                { text: "Kompresja danych", correct: false },
                { text: "Routing", correct: false }
            ]
        },
        {
            question: "W konfiguracji 'crypto map', co oznacza 'ipsec-isakmp'?",
            type: "single",
            answers: [
                { text: "呕e klucze bd wpisywane rcznie", correct: false },
                { text: "呕e u偶ywany jest protok贸 automatycznej wymiany kluczy (IKE)", correct: true },
                { text: "呕e tunel jest nieaktywny", correct: false },
                { text: "呕e u偶ywamy tylko AH", correct: false }
            ]
        },
        {
            question: "Jakie jest zagro偶enie, przed kt贸rym chroni 'Anti-replay'?",
            type: "single",
            answers: [
                { text: "Przechwycenie pakietu i jego ponowne wysanie przez atakujcego", correct: true },
                { text: "Odszyfrowanie treci", correct: false },
                { text: "Zmiana adresu IP nadawcy", correct: false },
                { text: "Usunicie pakietu", correct: false }
            ]
        },
        {
            question: "Co si stanie po wpisaniu 'clear crypto sa'?",
            type: "single",
            answers: [
                { text: "Usunie si konfiguracja VPN", correct: false },
                { text: "Zostan skasowane aktywne tunele (relacje zabezpiecze)", correct: true },
                { text: "Zrestartuje si router", correct: false },
                { text: "Wyczyci si lista ACL", correct: false }
            ]
        },
        {
            question: "W kt贸rym trybie nag贸wek IPSec (AH/ESP) jest umieszczany PO oryginalnym nag贸wku IP?",
            type: "single",
            answers: [
                { text: "Tryb tunelowy", correct: false },
                { text: "Tryb transportowy", correct: true },
                { text: "W obu", correct: false },
                { text: "W 偶adnym", correct: false }
            ]
        },
        {
            question: "Jaka jest domylna rola ISAKMP w IPSec?",
            type: "single",
            answers: [
                { text: "Szyfrowanie pakiet贸w danych", correct: false },
                { text: "Zarzdzanie kluczami i negocjacja parametr贸w bezpieczestwa", correct: true },
                { text: "Kompresja danych", correct: false },
                { text: "Ruting pakiet贸w", correct: false }
            ]
        },

        // ==========================================
        // NOWE 30 PYTA (WIELOKROTNEGO WYBORU - TWARDE)
        // ==========================================
        {
            question: "Jakie parametry definiujemy wewntrz 'crypto isakmp policy' (Faza I)? (Zaznacz wszystkie poprawne)",
            type: "multi",
            answers: [
                { text: "encryption (np. aes, 3des)", correct: true },
                { text: "hash (np. sha, md5)", correct: true },
                { text: "mode tunnel", correct: false }, // To faza 2
                { text: "group (Diffie-Hellman)", correct: true },
                { text: "authentication (np. pre-share)", correct: true },
                { text: "set peer", correct: false } // To crypto map
            ]
        },
        {
            question: "Wska偶 cechy charakterystyczne trybu TUNELOWEGO w IPSec: (Zaznacz wszystkie)",
            type: "multi",
            answers: [
                { text: "Oryginalny nag贸wek IP jest szyfrowany (w przypadku ESP)", correct: true },
                { text: "Dodawany jest zupenie nowy nag贸wek IP", correct: true },
                { text: "Oryginalny nag贸wek IP pozostaje jawny", correct: false },
                { text: "Stosowany g贸wnie w relacji Brama-Brama (Site-to-Site)", correct: true },
                { text: "Stosowany g贸wnie w relacji Host-Host", correct: false }
            ]
        },
        {
            question: "Co znajduje si w konfiguracji 'transform-set' (Faza II)? (Zaznacz wszystkie)",
            type: "multi",
            answers: [
                { text: "Algorytm szyfrowania danych (np. esp-aes)", correct: true },
                { text: "Algorytm haszowania danych (np. esp-sha-hmac)", correct: true },
                { text: "Klucz pre-shared key", correct: false }, // Faza 1
                { text: "Tryb tunelowania (mode tunnel/transport)", correct: true },
                { text: "Czas 偶ycia IKE (lifetime)", correct: false } // Faza 1
            ]
        },
        {
            question: "Jakie funkcje peni protok贸 ESP? (Zaznacz wszystkie)",
            type: "multi",
            answers: [
                { text: "Poufno (Szyfrowanie)", correct: true },
                { text: "Integralno danych", correct: true },
                { text: "Uwierzytelnianie 藕r贸da", correct: true },
                { text: "Tylko i wycznie integralno (bez szyfrowania)", correct: false }, // To AH
                { text: "Routing dynamiczny", correct: false }
            ]
        },
        {
            question: "Co zobaczysz w wynikach polecenia 'show crypto ipsec sa'? (Zaznacz wszystkie)",
            type: "multi",
            answers: [
                { text: "Liczb zaszyfrowanych pakiet贸w (pkts encaps)", correct: true },
                { text: "Liczb odszyfrowanych pakiet贸w (pkts decaps)", correct: true },
                { text: "Aktualne SPI (Security Parameter Index)", correct: true },
                { text: "Haso w formie jawnej", correct: false },
                { text: "Status interfejs贸w fizycznych", correct: false }
            ]
        },
        {
            question: "Kt贸re algorytmy su偶 do zapewnienia POUFNOCI (Szyfrowania)? (Zaznacz wszystkie)",
            type: "multi",
            answers: [
                { text: "AES", correct: true },
                { text: "3DES", correct: true },
                { text: "DES", correct: true },
                { text: "SHA-1", correct: false }, // Hash
                { text: "MD5", correct: false }, // Hash
                { text: "Diffie-Hellman", correct: false } // Wymiana kluczy
            ]
        },
        {
            question: "Kt贸re algorytmy su偶 do zapewnienia INTEGRALNOCI (Funkcje skr贸tu)? (Zaznacz wszystkie)",
            type: "multi",
            answers: [
                { text: "MD5", correct: true },
                { text: "SHA-1", correct: true },
                { text: "SHA-256", correct: true },
                { text: "AES", correct: false },
                { text: "RSA", correct: false }
            ]
        },
        {
            question: "Jakie parametry musz by TAKIE SAME na obu routerach w Fazie I, aby tunel wsta? (Zaznacz wszystkie)",
            type: "multi",
            answers: [
                { text: "Algorytm szyfrowania (Encryption)", correct: true },
                { text: "Algorytm haszowania (Hash)", correct: true },
                { text: "Metoda uwierzytelniania (Authentication)", correct: true },
                { text: "Grupa Diffie-Hellman", correct: true },
                { text: "Nazwa Crypto Mapy", correct: false }, // Nazwa lokalna
                { text: "Nazwa listy ACL", correct: false } // Nazwa lokalna
            ]
        },
        {
            question: "Wybierz poprawne komendy skadowe konfiguracji Crypto Mapy: (Zaznacz wszystkie)",
            type: "multi",
            answers: [
                { text: "match address [nr_acl]", correct: true },
                { text: "set peer [adres_ip]", correct: true },
                { text: "set transform-set [nazwa]", correct: true },
                { text: "encryption aes", correct: false }, // To w policy
                { text: "hash sha", correct: false } // To w policy
            ]
        },
        {
            question: "Jakie s mo偶liwe metody uwierzytelniania w 'crypto isakmp policy'? (Zaznacz wszystkie)",
            type: "multi",
            answers: [
                { text: "pre-share", correct: true },
                { text: "rsa-sig", correct: true },
                { text: "rsa-encr", correct: true },
                { text: "md5-auth", correct: false },
                { text: "aes-auth", correct: false }
            ]
        },
        {
            question: "Jakie cechy posiada Tryb Transportowy? (Zaznacz wszystkie)",
            type: "multi",
            answers: [
                { text: "Nag贸wek IPSec jest wstawiany midzy IP a dane (TCP/UDP)", correct: true },
                { text: "Oryginalny nag贸wek IP jest widoczny", correct: true },
                { text: "Stosowany g贸wnie do pocze Host-Host", correct: true },
                { text: "Ukrywa adresy IP nadawcy i odbiorcy", correct: false },
                { text: "Dodaje nowy nag贸wek IP", correct: false }
            ]
        },
        {
            question: "Dlaczego stosujemy ACL w konfiguracji IPSec? (Zaznacz wszystkie)",
            type: "multi",
            answers: [
                { text: "Aby wskaza 'interesujcy ruch' do szyfrowania", correct: true },
                { text: "Aby zablokowa ruch niepo偶dany w tunelu", correct: true },
                { text: "Aby skonfigurowa adres IP interfejsu", correct: false },
                { text: "Aby wczy routing OSPF", correct: false }
            ]
        },
        {
            question: "Jakie informacje zawiera Security Association (SA)? (Zaznacz wszystkie)",
            type: "multi",
            answers: [
                { text: "SPI (Security Parameter Index)", correct: true },
                { text: "Adres IP docelowy", correct: true },
                { text: "Protok贸 zabezpiecze (AH lub ESP)", correct: true },
                { text: "List plik贸w na serwerze", correct: false },
                { text: "Wersj systemu operacyjnego routera", correct: false }
            ]
        },
        {
            question: "Jakie s numery grup Diffie-Hellman? (Zaznacz przykadowe poprawne)",
            type: "multi",
            answers: [
                { text: "Group 1", correct: true },
                { text: "Group 2", correct: true },
                { text: "Group 5", correct: true },
                { text: "Group 100", correct: false },
                { text: "Group AES", correct: false }
            ]
        },
        {
            question: "Jakie kroki s niezbdne do uruchomienia VPN Site-to-Site? (Zaznacz wszystkie)",
            type: "multi",
            answers: [
                { text: "Konfiguracja ISAKMP Policy (Faza 1)", correct: true },
                { text: "Konfiguracja klucza (Key)", correct: true },
                { text: "Konfiguracja Transform-Set (Faza 2)", correct: true },
                { text: "Utworzenie ACL dla ruchu VPN", correct: true },
                { text: "Przypisanie Crypto Map do interfejsu", correct: true }
            ]
        },
        {
            question: "Jakie polecenia 'debug' s przydatne przy problemach z IPSec? (Zaznacz wszystkie)",
            type: "multi",
            answers: [
                { text: "debug crypto isakmp", correct: true },
                { text: "debug crypto ipsec", correct: true },
                { text: "debug ip packet", correct: false }, // Zbyt og贸lne/niebezpieczne
                { text: "debug vlan", correct: false }
            ]
        },
        {
            question: "Co si stanie, jeli Faza I (ISAKMP) zakoczy si niepowodzeniem? (Zaznacz wszystkie)",
            type: "multi",
            answers: [
                { text: "Faza II (IPSec) w og贸le si nie rozpocznie", correct: true },
                { text: "Klucze szyfrujce nie zostan wymienione", correct: true },
                { text: "Tunel bdzie dziaa, ale bez szyfrowania", correct: false },
                { text: "Ruch bdzie przesyany otwartym tekstem", correct: false } // Zazwyczaj zostanie odrzucony
            ]
        },
        {
            question: "Jakie role peni algorytmy w IPSec? (Zaznacz poprawne pary)",
            type: "multi",
            answers: [
                { text: "Algorytmy symetryczne (AES) -> Szyfrowanie danych", correct: true },
                { text: "Algorytmy asymetryczne (DH) -> Wymiana kluczy", correct: true },
                { text: "Algorytmy skr贸tu (SHA) -> Integralno", correct: true },
                { text: "Algorytmy symetryczne -> Wymiana kluczy", correct: false }
            ]
        },
        {
            question: "Wska偶 poprawne maski 'wildcard' w ACL dla sieci 192.168.1.0/24: (Zaznacz poprawne)",
            type: "multi",
            answers: [
                { text: "0.0.0.255", correct: true },
                { text: "255.255.255.0", correct: false }, // To maska podsieci
                { text: "0.0.0.0 (dla konkretnego hosta)", correct: false }, // Pytanie o sie /24
                { text: "0.0.255.255", correct: false }
            ]
        },
        {
            question: "Do czego su偶y polecenie 'set peer' w konfiguracji mapy? (Zaznacz wszystkie)",
            type: "multi",
            answers: [
                { text: "Wskazuje adres IP drugiego koca tunelu", correct: true },
                { text: "Definiuje bram VPN partnera", correct: true },
                { text: "Ustawia m贸j adres lokalny", correct: false },
                { text: "Ustawia haso", correct: false }
            ]
        },
        {
            question: "Jaki jest cel mechanizmu Anti-Replay? (Zaznacz wszystkie)",
            type: "multi",
            answers: [
                { text: "Zapobieganie wstrzykniciu przechwyconego starego pakietu", correct: true },
                { text: "Wykorzystanie numer贸w sekwencyjnych (Sequence Numbers)", correct: true },
                { text: "Szyfrowanie nag贸wka TCP", correct: false },
                { text: "Kompresja danych", correct: false }
            ]
        },
        {
            question: "Co robi polecenie 'clear crypto sa'? (Zaznacz wszystkie)",
            type: "multi",
            answers: [
                { text: "Usuwa aktywne tunele (Security Associations)", correct: true },
                { text: "Wymusza ponown negocjacj kluczy przy nowym ruchu", correct: true },
                { text: "Usuwa konfiguracj z running-config", correct: false },
                { text: "Restartuje urzdzenie", correct: false }
            ]
        },
        {
            question: "Czym charakteryzuje si algorytm Diffie-Hellman? (Zaznacz wszystkie)",
            type: "multi",
            answers: [
                { text: "Jest algorytmem asymetrycznym", correct: true },
                { text: "Pozwala na bezpieczne ustalenie wsp贸lnego sekretu w niezaufanym kanale", correct: true },
                { text: "Su偶y do szyfrowania du偶ych iloci danych u偶ytkownika", correct: false }, // Za wolny, u偶ywa si symetrycznych
                { text: "Jest funkcj skr贸tu", correct: false }
            ]
        },
        {
            question: "Jakie protokoy warstwy transportowej/internetowej wykorzystuje IPSec? (Zaznacz wszystkie)",
            type: "multi",
            answers: [
                { text: "ESP (protok贸 50)", correct: true },
                { text: "AH (protok贸 51)", correct: true },
                { text: "UDP (port 500 dla ISAKMP)", correct: true },
                { text: "TCP (port 80)", correct: false },
                { text: "ICMP", correct: false }
            ]
        },
        {
            question: "Co si dzieje w przypadku u偶ycia NAT po drodze tunelu IPSec? (Zaznacz wszystkie)",
            type: "multi",
            answers: [
                { text: "AH nie zadziaa (naruszenie integralnoci nag贸wka IP)", correct: true },
                { text: "Wymagane jest NAT-Traversal (NAT-T)", correct: true },
                { text: "ISAKMP przecza si na port UDP 4500", correct: true },
                { text: "Wszystko dziaa bez dodatkowej konfiguracji", correct: false }
            ]
        },
        {
            question: "Wska偶 cechy kluczy w kryptografii symetrycznej: (Zaznacz wszystkie)",
            type: "multi",
            answers: [
                { text: "Ten sam klucz su偶y do szyfrowania i deszyfrowania", correct: true },
                { text: "Jest szybsza ni偶 asymetryczna", correct: true },
                { text: "Stosowana w Fazie II (ESP) do danych", correct: true },
                { text: "U偶ywa pary kluczy prywatny/publiczny", correct: false }
            ]
        },
        {
            question: "Co oznacza skr贸t CA w kontekcie VPN i PKI? (Zaznacz wszystkie)",
            type: "multi",
            answers: [
                { text: "Certificate Authority (Urzd Certyfikacji)", correct: true },
                { text: "Podmiot wydajcy certyfikaty cyfrowe", correct: true },
                { text: "Crypto Algorithm", correct: false },
                { text: "Connection Acceptor", correct: false }
            ]
        },
        {
            question: "Co definiuje parametr 'lifetime' w konfiguracji IPSec? (Zaznacz wszystkie)",
            type: "multi",
            answers: [
                { text: "Czas, po kt贸rym klucze musz zosta wymienione (re-key)", correct: true },
                { text: "Mo偶e by wyra偶ony w sekundach lub kilobajtach danych", correct: true },
                { text: "Czas do wyczenia routera", correct: false },
                { text: "Op贸藕nienie pakietu", correct: false }
            ]
        },
        {
            question: "W jaki spos贸b mo偶na sprawdzi konfiguracj Fazy I? (Zaznacz poprawne)",
            type: "multi",
            answers: [
                { text: "show crypto isakmp policy", correct: true },
                { text: "show crypto isakmp sa", correct: true }, // Pokazuje stan (QM_IDLE itp)
                { text: "show crypto ipsec sa", correct: false }, // To faza 2
                { text: "show ip interface brief", correct: false }
            ]
        }
    ];

    // Funkcja mieszajca (Fisher-Yates)
    function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
    }

    function renderQuestions() {
        const container = document.getElementById('questions-container');
        container.innerHTML = '';
        
        // Mieszamy kolejno pyta
        shuffleArray(questionsDB);

        questionsDB.forEach((q, index) => {
            // Mieszamy odpowiedzi
            shuffleArray(q.answers);

            const qBlock = document.createElement('div');
            qBlock.className = 'question-block';

            // Dodaj klas wyr贸偶niajc jeli to pytanie ze zdjcia
            if(q.isSource) {
                qBlock.classList.add('source-question-block');
            }

            const qTitle = document.createElement('div');
            qTitle.className = 'question-text';
            if(q.isSource) {
                qTitle.classList.add('source-question');
            }
            // Numeracja 1..80
            qTitle.innerHTML = (index + 1) + ". " + q.question;
            
            // Oznaczenie 藕r贸da (dla pewnoci)
            if(q.isSource) {
                const tag = document.createElement('span');
                tag.className = 'source-tag';
                tag.innerText = "ZE ZDJCIA";
                qTitle.appendChild(tag);
            }
            
            const qType = document.createElement('span');
            qType.className = 'type-badge';
            qType.innerText = q.type === 'multi' ? "(Wielokrotny wyb贸r)" : "(Jednokrotny wyb贸r)";

            const optionsList = document.createElement('ul');
            optionsList.className = 'options';

            q.answers.forEach((ans, ansIndex) => {
                const li = document.createElement('li');
                li.className = 'option';
                
                const inputType = q.type === 'multi' ? 'checkbox' : 'radio';
                const inputName = 'q' + index;
                const inputId = 'q' + index + 'a' + ansIndex;

                const input = document.createElement('input');
                input.type = inputType;
                input.name = inputName;
                input.id = inputId;
                input.value = ans.correct; 

                const label = document.createElement('label');
                label.htmlFor = inputId;
                label.innerText = ans.text;
                label.style.cursor = 'pointer';
                label.style.width = "100%";

                // Logika kliknicia - natychmiastowa weryfikacja
                li.onclick = function(e) {
                    if (e.target !== input) {
                        input.checked = !input.checked;
                        if(inputType === 'radio') {
                             const siblings = optionsList.querySelectorAll('.option');
                             siblings.forEach(sib => {
                                 sib.classList.remove('correct-clicked', 'wrong-clicked');
                                 const sibInput = sib.querySelector('input');
                                 if(sibInput !== input) sibInput.checked = false;
                             });
                        }
                    }
                    
                    if (ans.correct) {
                        li.classList.add('correct-clicked');
                        li.classList.remove('wrong-clicked');
                    } else {
                        li.classList.add('wrong-clicked');
                        li.classList.remove('correct-clicked');
                    }
                };
                
                input.onclick = function(e) {
                    e.stopPropagation();
                     if(inputType === 'radio') {
                         const siblings = optionsList.querySelectorAll('.option');
                         siblings.forEach(sib => sib.classList.remove('correct-clicked', 'wrong-clicked'));
                    }
                    if (ans.correct) {
                        li.classList.add('correct-clicked');
                        li.classList.remove('wrong-clicked');
                    } else {
                        li.classList.add('wrong-clicked');
                        li.classList.remove('correct-clicked');
                    }
                }

                li.appendChild(input);
                li.appendChild(label);
                optionsList.appendChild(li);
            });

            qBlock.appendChild(qTitle);
            qBlock.appendChild(qType);
            qBlock.appendChild(optionsList);
            container.appendChild(qBlock);
        });
    }

    function checkScore() {
        const blocks = document.querySelectorAll('.question-block');
        let score = 0;
        let total = blocks.length;

        blocks.forEach((block, index) => {
            const type = questionsDB[index].type;
            const inputs = block.querySelectorAll('input');
            let isCorrect = true;

            if (type === 'single') {
                let selected = false;
                inputs.forEach(inp => {
                    if (inp.checked) {
                        selected = true;
                        if (inp.value !== 'true') isCorrect = false;
                    }
                });
                if (!selected) isCorrect = false;
            } else {
                // Multi - rygorystyczne sprawdzanie
                let hasSelection = false;
                inputs.forEach(inp => {
                    if (inp.checked) hasSelection = true;
                    if (inp.value === 'true' && !inp.checked) isCorrect = false;
                    if (inp.value === 'false' && inp.checked) isCorrect = false;
                });
                if (!hasSelection) isCorrect = false;
            }

            if (isCorrect) score++;
        });

        const resultBox = document.getElementById('result-box');
        const percent = Math.round((score / total) * 100);
        
        let msg = `Tw贸j wynik: ${score} / ${total} (${percent}%)`;
        if (percent === 100) msg += " <br> Jeste gotowy na 5.0! ";
        else if (percent >= 80) msg += " <br> Bardzo dobrze! Zdasz bez problemu. ";
        else if (percent >= 50) msg += " <br> Nie藕le, ale przejrzyj jeszcze raz pytania ze zdj.";
        else msg += " <br> Wracaj do nauki! Przeczytaj notatk na g贸rze.";

        resultBox.innerHTML = msg;
        resultBox.style.display = 'block';
        
        // Przewi do wyniku
        resultBox.scrollIntoView({behavior: "smooth"});
    }

    // Start
    renderQuestions();

</script>

</body>
</html>
